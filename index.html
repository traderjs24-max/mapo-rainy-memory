<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Union Oracle</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700&display=swap" rel="stylesheet">
    <style>
        /* [Í∏∞Î≥∏ ÏÑ§Ï†ï] */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Noto Sans KR', sans-serif; }
        body, html { width: 100%; height: 100%; overflow: hidden; background-color: transparent; }

        /* Î∞∞Í≤Ω ÏÑ§Ï†ï */
        .video-bg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; z-index: -1; opacity: 0.7;
            background-image: url('https://images.pexels.com/photos/1102909/pexels-photo-1102909.jpeg?auto=compress&cs=tinysrgb&w=1600');
            background-size: cover; background-position: center;
        }

        .black-backdrop { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #111; z-index: -2; }

        .container {
            position: relative; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            background: rgba(0,0,0,0.4); color: #fff; text-align: center; z-index: 10;
            padding-bottom: 80px;
        }

        /* ÌÉÄÏù¥ÌãÄ */
        .title {
            font-size: 4.5rem; font-weight: 700; margin-bottom: 5px;
            letter-spacing: -2px; text-shadow: 0 10px 30px rgba(0,0,0,0.5);
            min-height: 1.2em; 
        }
        .cursor {
            display: inline-block; width: 3px; height: 1em; background-color: #fff;
            margin-left: 5px; animation: blink 1s infinite; vertical-align: middle;
        }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

        .subtitle {
            font-size: 1.1rem; font-weight: 300; letter-spacing: 2px; opacity: 0.9;
            margin-bottom: 20px; animation: fadeIn 3s ease-in-out 1s backwards;
        }

        /* ÏãúÍ≥Ñ */
        #real-time-clock {
            font-size: 0.9rem; font-weight: 300; letter-spacing: 1px;
            opacity: 0.7; border: 1px solid rgba(255,255,255,0.3);
            padding: 5px 15px; border-radius: 20px;
            animation: fadeIn 3s ease-in-out 2s backwards;
        }

        .start-btn {
            margin-top: 50px; padding: 15px 45px;
            border: 1px solid rgba(255,255,255,0.6); background: transparent;
            color: #fff; font-weight: 500; cursor: pointer; transition: 0.3s;
            backdrop-filter: blur(5px); animation: fadeIn 3s ease-in-out 2.5s backwards;
        }
        .start-btn:hover { background: #fff; color: #000; border-color: #fff; transform: translateY(-3px); }

        /* Î≤ÑÌäº Í∑∏Î£π */
        .button-group { margin-top: 40px; display: none; gap: 10px; flex-wrap: wrap; justify-content: center; }
        .menu-btn {
            padding: 12px 25px; border: 1px solid rgba(255,255,255,0.3);
            background: rgba(0,0,0,0.3); color: #eee; font-weight: 400;
            cursor: pointer; transition: 0.3s;
        }
        .menu-btn:hover { background: #fff; color: #000; border-color: #fff; }

        /* ÏÇ¨Ïö¥Îìú Ïª®Ìä∏Î°§ */
        .sound-controls {
            position: absolute; bottom: 40px; right: 40px;
            background: rgba(0, 0, 0, 0.7); padding: 20px;
            border-radius: 12px; backdrop-filter: blur(10px);
            display: none; text-align: left; z-index: 999;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .control-group { margin-bottom: 15px; display: flex; align-items: center; justify-content: space-between; }
        .control-group:last-child { margin-bottom: 0; }
        .label { font-size: 0.9rem; margin-right: 10px; display: block; opacity: 0.9; font-weight: 400; width: 80px; }
        input[type=range] {
            -webkit-appearance: none; width: 140px; height: 6px; 
            background: rgba(255,255,255,0.2); border-radius: 5px; outline: none; cursor: pointer;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; appearance: none;
            width: 18px; height: 18px; border-radius: 50%; 
            background: #fff; cursor: pointer; transition: 0.2s;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    
        /* Î™®Îã¨ Í≥µÌÜµ */
        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.9); z-index: 1000; backdrop-filter: blur(10px);
            justify-content: center; align-items: center; animation: fadeIn 0.4s; color: #fff;
        }
        .close-btn {
            position: absolute; top: 30px; right: 40px; font-size: 2.5rem;
            cursor: pointer; background: none; border: none; color: #fff;
            transition: 0.3s; z-index: 101; font-weight: 100;
        }
        .close-btn:hover { transform: rotate(90deg); color: #ccc; }

        /* ÎÆ§ÏßÅÎ£∏ */
        .music-room { width: 90%; max-width: 900px; height: 80vh; display: flex; gap: 50px; }
        .music-list { flex: 1; border-right: 1px solid rgba(255,255,255,0.1); padding-right: 30px; overflow-y: auto; }
        .track-item {
            padding: 20px 10px; border-bottom: 1px solid rgba(255,255,255,0.05);
            cursor: pointer; transition: 0.3s; display: flex; justify-content: space-between; align-items: center;
            color: rgba(255, 255, 255, 0.6); 
        }
        .track-item:hover { background: rgba(255,255,255,0.05); padding-left: 20px; color: #fff; }
        .track-item.active { color: #fff; font-weight: 700; border-left: 3px solid #fff; padding-left: 20px; background: rgba(255,255,255,0.02); }
        .track-title { font-size: 1.1rem; margin-bottom: 5px; }
        .track-artist { font-size: 0.8rem; opacity: 0.5; font-weight: 300; }
        .music-info { flex: 1.2; padding: 20px; display: flex; flex-direction: column; justify-content: center; }
        .info-title { font-size: 2.5rem; font-weight: 700; margin-bottom: 10px; letter-spacing: -1px; }
        .info-artist { font-size: 1rem; opacity: 0.6; margin-bottom: 40px; font-weight: 300; border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 20px; display: inline-block;}
        .info-desc { font-size: 1rem; line-height: 1.8; opacity: 0.8; white-space: pre-line; font-weight: 300; }

        /* Îã§Ïù¥Ïñ¥Î¶¨/Î∞©Î™ÖÎ°ù */
        .diary-paper, .guestbook-paper, .novel-paper {
            background: #1a1a1a; border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 50px; width: 90%; max-width: 600px; height: 80vh;
            overflow-y: auto; color: #eee; 
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            display: flex; flex-direction: column;
        }
        .novel-paper { max-width: 800px; }
        .diary-form { margin-bottom: 40px; padding-bottom: 30px; border-bottom: 1px solid rgba(255,255,255,0.2); }
        .input-group { margin-bottom: 15px; text-align: left; }
        .input-label { display: block; font-size: 0.8rem; opacity: 0.6; margin-bottom: 5px; }
        .custom-input, .custom-textarea {
            width: 100%; background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1); color: #fff;
            padding: 10px; font-size: 1rem; outline: none; transition: 0.3s;
        }
        .custom-textarea { height: 100px; resize: none; }
        .novel-textarea { height: 300px; line-height: 1.8; font-size: 1.05rem; }
        .write-btn {
            width: 100%; padding: 12px; background: #fff; color: #000;
            border: none; font-weight: 700; cursor: pointer; transition: 0.3s;
        }
        .write-btn:hover { background: #ddd; }
        .write-btn.edit-mode { background: #ffd700; } 
        .diary-entry, .guestbook-entry { 
            background: rgba(255,255,255,0.03); padding: 25px; margin-bottom: 20px; text-align: left; position: relative;
        }
        .diary-title { font-weight: 700; font-size: 1.4rem; margin-bottom: 10px; color: #fff; padding-right: 140px; word-break: keep-all; }
        .diary-date { font-size: 0.8rem; opacity: 0.5; margin-bottom: 15px; display: block; }
        .diary-content { font-size: 0.95rem; opacity: 0.8; line-height: 1.8; white-space: pre-line; }
        .entry-actions { position: absolute; top: 20px; right: 20px; display: flex; gap: 8px; }
        .action-btn {
            background: transparent; border: 1px solid rgba(255,255,255,0.2);
            color: rgba(255,255,255,0.5); font-size: 0.7rem; padding: 5px 10px;
            cursor: pointer; transition: 0.3s;
        }
        .guestbook-entry { border-left: 2px solid #aaa; padding: 20px; }
        .gb-header { display: flex; justify-content: space-between; margin-bottom: 8px; align-items: flex-end; }
        .gb-name { font-weight: 700; font-size: 1.1rem; color: #fff; }
        .gb-date { font-size: 0.75rem; opacity: 0.5; }
        .gb-message { font-size: 0.95rem; opacity: 0.9; white-space: pre-line; line-height: 1.6; }
        .map-window {
            width: 80%; height: 80%; max-width: 1000px;
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
        }
        .dark-map { width: 100%; height: 100%; border: 0; filter: invert(100%) hue-rotate(180deg) contrast(1.2) grayscale(0.2); }

        /* Î™®Î∞îÏùº ÏµúÏ†ÅÌôî */
        @media (max-width: 768px) {
            .music-room { flex-direction: column; overflow-y: auto; }
            .music-list { height: 250px; border-right: none; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 20px; margin-bottom: 20px; }
            .title { font-size: 2.8rem; }
            .diary-paper, .guestbook-paper, .novel-paper { padding: 30px; width: 95%; height: 75vh; }
            .container { padding-bottom: 140px; }
            .sound-controls {
                position: fixed; bottom: 0; left: 0; right: 0; width: 100%;
                border-radius: 20px 20px 0 0; background: rgba(17, 17, 17, 0.95);
                padding: 25px 30px 40px 30px; border: none; border-top: 1px solid rgba(255,255,255,0.15); display: none;
            }
            .control-group { margin-bottom: 20px; }
            input[type=range] { width: 100%; flex: 1; height: 8px; margin-left: 15px; }
            input[type=range]::-webkit-slider-thumb { width: 24px; height: 24px; }
        }
    </style>
</head>
<body>

    <div class="black-backdrop"></div>
    <video class="video-bg" autoplay muted loop playsinline><source src="london_rain.mp4" type="video/mp4"></video>
    
    <audio id="bg-music"><source src="chopin_raindrop.mp3" type="audio/mp3"></audio> 
    <audio id="rain" loop><source src="rain_sound.mp3" type="audio/mp3"></audio>

    <div class="container">
        <h1 class="title"><span id="typing-text"></span><span class="cursor"></span></h1>
        <p class="subtitle">ÌïòÎäòÍ≥µÏõêÏùò ÏñµÏÉà, Í∑∏Î¶¨Í≥† ÏáºÌåΩ</p>
        <div id="real-time-clock">00:00:00</div>
        
        <button class="start-btn" onclick="startExperience()">ÏÇ∞Ï±Ö ÏãúÏûëÌïòÍ∏∞</button>
        
        <div class="button-group">
            <button class="menu-btn" onclick="openModal('musicModal')">üéß Music Room</button>
            <button class="menu-btn" onclick="openModal('diaryModal')">üìñ Diary</button>
            <button class="menu-btn" onclick="openModal('novelModal')">‚úçÔ∏è Novel Studio</button>
            <button class="menu-btn" onclick="openModal('guestbookModal')">üñäÔ∏è Guestbook</button>
            <button class="menu-btn" onclick="openModal('mapModal')">üó∫Ô∏è Map</button>
        </div>
    </div>

    <div class="sound-controls" id="mixer">
        <div class="control-group">
            <span class="label">Music</span>
            <input type="range" min="0" max="1" step="0.05" value="0.5" oninput="setVolume('bg-music', this.value)">
        </div>
        <div class="control-group">
            <span class="label">Rain</span>
            <input type="range" min="0" max="1" step="0.05" value="0.5" oninput="setVolume('rain', this.value)">
        </div>
    </div>

    <div class="modal-overlay" id="musicModal">
        <button class="close-btn" onclick="closeModal('musicModal')">√ó</button>
        <div class="music-room">
            <div class="music-list" id="playlist-container"></div>
            <div class="music-info">
                <h2 class="info-title" id="track-title">Select Music</h2>
                <p class="info-artist" id="track-artist">Union Oracle Playlist</p>
                <p class="info-desc" id="track-desc">Ïù¥ÏÑ±Í≥º Í∞êÏÑ±Ïù¥ Í≥µÏ°¥ÌïòÎäî ÎãπÏã†ÏùÑ ÏúÑÌïú ÏÑ†Í≥°.<br>ÎπóÏÜåÎ¶¨ÏôÄ Ìï®Íªò ÍπäÏùÄ ÏÇ¨ÏÉâÏóê Ïû†Í≤®Î≥¥ÏÑ∏Ïöî.</p>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="diaryModal">
        <div class="diary-paper">
            <button class="close-btn" onclick="closeModal('diaryModal')">√ó</button>
            <div class="diary-form">
                <div class="input-group"><label class="input-label">Title</label><input type="text" id="input-title" class="custom-input" placeholder="Ïò§ÎäòÏùò Ï†úÎ™©"></div>
                <div class="input-group"><label class="input-label">Content</label><textarea id="input-content" class="custom-textarea" placeholder="ÏÉùÍ∞ÅÏùÑ Í∏∞Î°ùÌïòÏÑ∏Ïöî..."></textarea></div>
                <button class="write-btn" id="save-btn" onclick="handleSave()">Í∏∞Î°ùÌïòÍ∏∞</button>
            </div>
            <div id="diary-container"></div>
        </div>
    </div>

    <div class="modal-overlay" id="novelModal">
        <div class="novel-paper">
            <button class="close-btn" onclick="closeModal('novelModal')">√ó</button>
            <h2 style="font-size: 1.8rem; font-weight: 700; margin-bottom: 20px; letter-spacing: -1px; color: #fff;">Novel Studio</h2>
            <div class="diary-form">
                <div class="input-group"><label class="input-label">Chapter Title</label><input type="text" id="novel-title" class="custom-input" placeholder="Ï±ïÌÑ∞ Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"></div>
                <div class="input-group"><label class="input-label">Story Content</label><textarea id="novel-content" class="custom-textarea novel-textarea" placeholder="ÎãπÏã†Ïùò Ïù¥ÏïºÍ∏∞Î•º ÏãúÏûëÌïòÏÑ∏Ïöî..."></textarea></div>
                <button class="write-btn" id="novel-save-btn" onclick="handleNovelSave()">Ï†ÄÏû•ÌïòÍ∏∞</button>
            </div>
            <div id="novel-container"></div>
        </div>
    </div>

    <div class="modal-overlay" id="guestbookModal">
        <div class="guestbook-paper">
            <button class="close-btn" onclick="closeModal('guestbookModal')">√ó</button>
            <h2 style="font-size: 1.8rem; font-weight: 700; margin-bottom: 20px; letter-spacing: -1px;">Visitors Book</h2>
            <div class="diary-form">
                <div class="input-group"><label class="input-label">Nickname</label><input type="text" id="gb-name" class="custom-input" placeholder="Î∞©Î¨∏Ïûê Ïù¥Î¶Ñ"></div>
                <div class="input-group"><label class="input-label">Message</label><textarea id="gb-message" class="custom-textarea" style="height: 60px;" placeholder="ÏßßÏùÄ Í∞êÏÉÅÏùÑ ÎÇ®Í≤®Ï£ºÏÑ∏Ïöî..."></textarea></div>
                <button class="write-btn" onclick="addGuestbook()">ÎÇ®Í∏∞Í∏∞</button>
            </div>
            <div id="guestbook-container"></div>
        </div>
    </div>

    <div class="modal-overlay" id="mapModal">
        <div class="map-window">
            <button class="close-btn" onclick="closeModal('mapModal')">√ó</button>
            <iframe class="dark-map" src="https://maps.google.com/maps?q=ÏÑúÏö∏+ÎßàÌè¨Íµ¨+ÌïòÎäòÍ≥µÏõê&t=m&z=15&output=embed&iwloc=near" allowfullscreen="" loading="lazy"></iframe>
        </div>
    </div>

    <script>
        const textToType = "Union Oracle";
        const typingElement = document.getElementById('typing-text');
        let typeIndex = 0;

        function typeWriter() {
            if (typeIndex < textToType.length) {
                typingElement.innerHTML += textToType.charAt(typeIndex);
                typeIndex++;
                setTimeout(typeWriter, 150);
            }
        }
        
        window.onload = function() {
            typeWriter();
            updateClock();
            setInterval(updateClock, 1000);
        };

        function updateClock() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('ko-KR', { hour12: false });
            document.getElementById('real-time-clock').innerText = "SEOUL " + timeString;
        }

        /* [Ï¥ù 13Í≥° ÌîåÎ†àÏù¥Î¶¨Ïä§Ìä∏] */
        const musicLibrary = [
            // Í∏∞Ï°¥ 8Í≥°
            { title: "Raindrop Prelude", artist: "Fr√©d√©ric Chopin", file: "chopin_raindrop.mp3", desc: "ÏáºÌåΩÏù¥ ÎπóÏÜåÎ¶¨Î•º Îì§ÏúºÎ©∞ ÏûëÍ≥°Ìïú Î™ÖÍ≥°." },
            { title: "The Four Seasons: Spring", artist: "Antonio Vivaldi", file: "spring.mp3", desc: "ÏÉùÎ™ÖÏù¥ ÏõÄÌä∏Îäî Î¥ÑÏùò Ìù¨Îßù." },
            { title: "The Four Seasons: Summer", artist: "Antonio Vivaldi", file: "summer.mp3", desc: "ÌïúÏó¨Î¶ÑÏùò Ìè≠ÌíçÏö∞." },
            { title: "The Four Seasons: Autumn", artist: "Antonio Vivaldi", file: "autumn.mp3", desc: "ÌíçÏöîÎ°úÏö¥ ÏàòÌôïÏùò Í≥ÑÏ†à." },
            { title: "Winter: II. Largo", artist: "Antonio Vivaldi", file: "winter_largo.mp3", desc: "Îî∞ÎúªÌïú ÎÇúÎ°úÍ∞ÄÏóêÏÑúÏùò ÌèâÏò®Ìï®." },
            { title: "Nocturne Op. 9 No. 1", artist: "Fr√©d√©ric Chopin", file: "nocturne_op9_1.mp3", desc: "Î∞§Ïùò Ï†ÅÎßâÍ≥º Ïì∏Ïì∏Ìï®." },
            { title: "Nocturne in C# minor", artist: "Fr√©d√©ric Chopin", file: "nocturne_c_sharp.mp3", desc: "Ïï†Ï†àÌïòÍ≥† ÎπÑÍ∑πÏ†ÅÏù∏ ÏïÑÎ¶ÑÎã§ÏõÄ." },
            { title: "Fantaisie-Impromptu", artist: "Fr√©d√©ric Chopin", file: "fantaisie_impromptu.mp3", desc: "ÍøàÍæ∏Îäî ÎìØÌïú ÌôòÏÉÅÍ≥°." },
            { title: "Air on the G String (BWV 1068)", artist: "J.S. Bach", file: "bach_air.mp3", desc: "GÏÑ† ÏúÑÏóêÏÑú ÌéºÏ≥êÏßÄÎäî Î∞îÌùêÏùò Ïà≠Í≥†Ìïú ÏïÑÎ¶¨ÏïÑ." },
            { title: "Canon in D (P. 37)", artist: "Johann Pachelbel", file: "pachelbel_canon.mp3", desc: "ÌèâÏò®ÌïòÍ≤å Î∞òÎ≥µÎêòÎäî ÏòÅÏõêÌïú Î©úÎ°úÎîî." },
            { title: "Nocturne Op. 9 No. 2", artist: "Fr√©d√©ric Chopin", file: "chopin_nocturne_2.mp3", desc: "Í∞ÄÏû• ÏÇ¨ÎûëÎ∞õÎäî ÏáºÌåΩÏùò Í∞êÏÑ± ÏïºÏÉÅÍ≥°." },
            { title: "Tr√§umerei (Dreaming)", artist: "Robert Schumann", file: "schumann_dreaming.mp3", desc: "Ïñ¥Î¶∞ ÏãúÏ†àÏùò ÍøàÏùÑ ÌöåÏÉÅÌïòÎäî Îî∞ÎúªÌï®." },
            { title: "Gymnop√©die No. 1", artist: "Fr√©d√©ric Chopin", file: "chopin_nocturne_1.mp3", desc: "Î™ΩÌôòÏ†ÅÏù¥Í≥† Ïã†ÎπÑÎ°úÏö¥ ÏÇ¨ÏÉâÏùò ÏãúÍ∞Ñ." }
        ];

        const bgMusic = document.getElementById('bg-music');
        const rainSound = document.getElementById('rain');
        
        let editingIndex = -1;
        let novelEditingIndex = -1;
        let currentTrackIndex = 0; 

        function startExperience() {
            document.querySelector('.start-btn').style.display = 'none';
            document.querySelector('.button-group').style.display = 'flex';
            document.getElementById('mixer').style.display = 'block';

            bgMusic.volume = 0.5; rainSound.volume = 0.5;
            
            renderPlaylist(); 
            loadDiaries(); 
            loadGuestbook(); 
            loadNovels();

            playTrack(0); 
            rainSound.play().catch(e => console.log("ÎπóÏÜåÎ¶¨ Ïû¨ÏÉù Ïã§Ìå®"));
        }

        bgMusic.addEventListener('ended', function() {
            currentTrackIndex = (currentTrackIndex + 1) % musicLibrary.length;
            playTrack(currentTrackIndex);
        });

        function setVolume(id, value) { 
            const audio = document.getElementById(id);
            if(audio) audio.volume = value; 
        }

        function openModal(id) { document.getElementById(id).style.display = 'flex'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }

        /* [ÏùºÍ∏∞Ïû•/ÏÜåÏÑ§/Î∞©Î™ÖÎ°ù Î°úÏßÅ ÏÉùÎûµ(ÏúÑÏôÄ ÎèôÏùº)] */
        const defaultDiaries = [{ title: "ÏÉÅÏïîÎèôÏùò ÏûøÎπõ Ïò§ÌõÑ", date: "2026.01.06 | Mapo, Seoul", content: `ÌïòÎäòÍ≥µÏõê Ï†ÑÎßùÎåÄÏóê Ïò¨Îùº ÎπóÏÜçÏóê Ïû†Í∏¥ ÏÑúÏö∏ÏùÑ Î≥∏Îã§.\nÏ†Ä Î©ÄÎ¶¨ ÌùêÎ•¥Îäî ÌïúÍ∞ï ÏúÑÎ°ú ÏòÖÏùÄ Î¨ºÏïàÍ∞úÍ∞Ä ÌîºÏñ¥Ïò§Î•¥Í≥†...` }];
        function handleSave() {
            const t = document.getElementById('input-title'); const c = document.getElementById('input-content');
            if(t.value.trim()==""||c.value.trim()==""){alert("ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî");return;}
            let d = JSON.parse(localStorage.getItem('myDiaries'))||defaultDiaries;
            if(editingIndex===-1) d.unshift({title:t.value, content:c.value, date:new Date().toLocaleDateString()});
            else { d[editingIndex]={title:t.value, content:c.value, date:new Date().toLocaleDateString()}; editingIndex=-1; document.getElementById('save-btn').innerText="Í∏∞Î°ùÌïòÍ∏∞"; document.getElementById('save-btn').classList.remove('edit-mode'); }
            localStorage.setItem('myDiaries', JSON.stringify(d)); renderDiaries(d); t.value=""; c.value="";
        }
        function editDiary(i){let d=JSON.parse(localStorage.getItem('myDiaries'))||defaultDiaries;document.getElementById('input-title').value=d[i].title;document.getElementById('input-content').value=d[i].content;editingIndex=i;let b=document.getElementById('save-btn');b.innerText="ÏàòÏ†ï ÏôÑÎ£å";b.classList.add('edit-mode');}
        function deleteDiary(i){if(confirm("ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?")){let d=JSON.parse(localStorage.getItem('myDiaries'))||defaultDiaries;d.splice(i,1);localStorage.setItem('myDiaries',JSON.stringify(d));renderDiaries(d);}}
        function loadDiaries(){let d=JSON.parse(localStorage.getItem('myDiaries'))||defaultDiaries;renderDiaries(d);}
        function renderDiaries(d){const c=document.getElementById('diary-container');c.innerHTML='';d.forEach((e,i)=>{c.innerHTML+=`<div class="diary-entry"><div class="entry-actions"><button class="action-btn" onclick="editDiary(${i})">ÏàòÏ†ï</button><button class="action-btn delete-btn" onclick="deleteDiary(${i})">ÏÇ≠Ï†ú</button></div><h2 class="diary-title">${e.title}</h2><span class="diary-date">${e.date}</span><p class="diary-content">${e.content}</p></div>`;});}

        const defaultNovels = [{ title: "Chapter 1. ÎπóÏÜåÎ¶¨", date: "2026.01.06", content: "Í∑∏ÎÇ†Îî∞Îùº ÎπÑÎäî Î©àÏ∂îÏßÄ ÏïäÍ≥† ÎÇ¥Î†∏Îã§.\nÍ∑∏Îäî Ï∞ΩÍ∞ÄÏóê ÏÑúÏÑú..." }];
        function handleNovelSave() {
            const t = document.getElementById('novel-title'); const c = document.getElementById('novel-content');
            if(t.value.trim()==""||c.value.trim()==""){alert("ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî");return;}
            let n = JSON.parse(localStorage.getItem('myNovels'))||defaultNovels;
            if(novelEditingIndex===-1) n.unshift({title:t.value, content:c.value, date:new Date().toLocaleDateString()});
            else { n[novelEditingIndex]={title:t.value, content:c.value, date:new Date().toLocaleDateString()}; novelEditingIndex=-1; document.getElementById('novel-save-btn').innerText="Ï†ÄÏû•ÌïòÍ∏∞"; document.getElementById('novel-save-btn').classList.remove('edit-mode'); }
            localStorage.setItem('myNovels', JSON.stringify(n)); renderNovels(n); t.value=""; c.value="";
        }
        function editNovel(i){let n=JSON.parse(localStorage.getItem('myNovels'))||defaultNovels;document.getElementById('novel-title').value=n[i].title;document.getElementById('novel-content').value=n[i].content;novelEditingIndex=i;let b=document.getElementById('novel-save-btn');b.innerText="ÏàòÏ†ï ÏôÑÎ£å";b.classList.add('edit-mode');document.querySelector('.novel-paper').scrollTop=0;}
        function deleteNovel(i){if(confirm("ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?")){let n=JSON.parse(localStorage.getItem('myNovels'))||defaultNovels;n.splice(i,1);localStorage.setItem('myNovels',JSON.stringify(n));renderNovels(n);}}
        function loadNovels(){let n=JSON.parse(localStorage.getItem('myNovels'))||defaultNovels;renderNovels(n);}
        function renderNovels(n){const c=document.getElementById('novel-container');c.innerHTML='';n.forEach((e,i)=>{c.innerHTML+=`<div class="diary-entry"><div class="entry-actions"><button class="action-btn" onclick="editNovel(${i})">ÏàòÏ†ï</button><button class="action-btn delete-btn" onclick="deleteNovel(${i})">ÏÇ≠Ï†ú</button></div><h2 class="diary-title">${e.title}</h2><span class="diary-date">${e.date}</span><p class="diary-content">${e.content}</p></div>`;});}

        const defaultGuestbook = [{ name: "ÏßÄÎÇòÍ∞ÄÎçò ÎÇòÍ∑∏ÎÑ§", date: "2026.01.06", message: "ÎπÑ Ïò§Îäî ÎÇ†Ïùò Í∞êÏÑ±Ïù¥ ÎÑàÎ¨¥ Ï¢ãÎÑ§Ïöî. Ïûò Ïâ¨Îã§ Í∞ëÎãàÎã§." }];
        function addGuestbook() {
            const n = document.getElementById('gb-name').value; const m = document.getElementById('gb-message').value;
            if(!n||!m)return alert("ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî");
            let g = JSON.parse(localStorage.getItem('mapoGuestbook'))||defaultGuestbook;
            g.unshift({name:n, message:m, date:new Date().toLocaleDateString()});
            localStorage.setItem('mapoGuestbook', JSON.stringify(g)); renderGuestbook(g);
            document.getElementById('gb-name').value=""; document.getElementById('gb-message').value="";
        }
        function loadGuestbook(){let g=JSON.parse(localStorage.getItem('mapoGuestbook'))||defaultGuestbook;renderGuestbook(g);}
        function renderGuestbook(g){const c=document.getElementById('guestbook-container');c.innerHTML='';g.forEach(e=>{c.innerHTML+=`<div class="guestbook-entry"><div class="gb-header"><span class="gb-name">${e.name}</span><span class="gb-date">${e.date}</span></div><p class="gb-message">${e.message}</p></div>`;});}

        function renderPlaylist() {
            const c = document.getElementById('playlist-container'); c.innerHTML='';
            musicLibrary.forEach((t, i) => {
                c.innerHTML += `<div class="track-item" onclick="playTrack(${i})"><div class="track-info"><div class="track-title">${t.title}</div><div class="track-artist">${t.artist}</div></div><div style="opacity:0.5;">‚ñ∂</div></div>`;
            });
        }
        function playTrack(index) {
            currentTrackIndex = index;
            const track = musicLibrary[index];
            bgMusic.src = track.file;
            bgMusic.play(); 
            // .catch(e => console.log('Ïû¨ÏÉù Ï§ÄÎπÑ Ï§ë')); 
            
            document.getElementById('track-title').innerText = track.title;
            document.getElementById('track-artist').innerText = track.artist;
            document.getElementById('track-desc').innerHTML = track.desc;
            
            const items = document.querySelectorAll('.track-item');
            items.forEach(item => item.classList.remove('active'));
            if(items[index]) items[index].classList.add('active');
        }
    </script>
</body>
</html>